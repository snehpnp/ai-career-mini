<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Neural AI Career Mentor</title>

<style>
body{
margin:0;
background:#020617;
font-family:Arial;
color:white;
}

.container{
max-width:900px;
margin:auto;
padding:20px;
}

h2{
text-align:center;
color:#38bdf8;
}

.chat{
height:520px;
overflow-y:auto;
background:#010409;
border-radius:14px;
padding:15px;
border:1px solid #1e293b;
}

.msg{
margin:12px 0;
padding:14px;
border-radius:12px;
max-width:75%;
line-height:1.6;
}

.user{background:#1d4ed8;margin-left:auto;}
.ai{background:#020617;border-left:4px solid #38bdf8;}

.card{
background:#020617;
border:1px solid #334155;
padding:10px;
margin-top:10px;
border-radius:10px;
}

.badge{
background:#38bdf8;
color:black;
padding:3px 7px;
border-radius:6px;
font-size:12px;
}

/* CHAT INPUT */
.chatInput{
display:none;
gap:10px;
margin-top:10px;
}

.chatInput input{
flex:1;
padding:12px;
border-radius:10px;
border:1px solid #334155;
background:#020617;
color:white;
}

button{
padding:12px;
background:#38bdf8;
color:black;
border:none;
border-radius:10px;
font-weight:bold;
cursor:pointer;
}

.modal{
position:fixed;
top:0;
left:0;
width:100%;
height:100%;
background:rgba(0,0,0,0.7);
display:flex;
justify-content:center;
align-items:center;
}

.modalBox{
background:#010409;
padding:20px;
border-radius:12px;
width:400px;
border:1px solid #1e293b;
}

input,select,textarea{
width:100%;
margin-top:8px;
padding:10px;
border-radius:8px;
border:1px solid #334155;
background:#020617;
color:white;
}

.typing{
color:#94a3b8;
font-style:italic;
}
</style>
</head>

<body>

<div class="container">

<h2>üß† Neural AI Career Mentor</h2>

<div id="chat" class="chat"></div>

<!-- ‚≠ê CHAT INPUT ACTIVE AFTER CAREER RESPONSE -->
<div id="chatInputBox" class="chatInput">
<input id="chatInput" placeholder="Ask more about skills, roadmap, growth..."/>
<button onclick="sendChat()">Send</button>
</div>

</div>

<!-- ‚≠ê FIRST TIME MODAL -->
<div id="modal" class="modal">
<div class="modalBox">
<h3>Quick Setup</h3>

<input id="name" placeholder="Your name"/>
<input id="age" placeholder="Age"/>

<select id="education">
<option value="graduate">Graduate</option>
<option value="postgraduate">Post Graduate</option>
<option value="btech">BTech</option>
</select>

<input id="interest" placeholder="Interests (tech,gaming,business...)"/>

<textarea id="goal" rows="2"
placeholder="What are you doing now & what you want after 3 years?"></textarea>

<button onclick="start()">Start AI Mentor</button>

</div>
</div>

<script>

const chat=document.getElementById("chat");
const modal=document.getElementById("modal");
const chatInputBox=document.getElementById("chatInputBox");

// ‚≠ê Smart Context Brain
function detectContext(text){

text=text.toLowerCase();

if(text.includes("skill")) return "skill";
if(text.includes("career")) return "career";
if(text.includes("risk")||text.includes("problem")) return "mindset";

return "general";
}

// UI helpers
function addUser(text){
chat.innerHTML+=`<div class="msg user">${text}</div>`;
chat.scrollTop=chat.scrollHeight;
}

function addAI(html){
chat.innerHTML+=`<div class="msg ai">${html}</div>`;
chat.scrollTop=chat.scrollHeight;
}

// ‚≠ê FIRST LOAD
if(localStorage.getItem("userData")){
modal.style.display="none";
sendCareer(JSON.parse(localStorage.getItem("userData")));
}

// ‚≠ê START ONBOARDING
function start(){

const user={
name:document.getElementById("name").value,
age:document.getElementById("age").value,
education:document.getElementById("education").value,
interest:[document.getElementById("interest").value],
goal:document.getElementById("goal").value,
hobby:""
};

localStorage.setItem("userData",JSON.stringify(user));

modal.style.display="none";

sendCareer(user);
}

// ‚≠ê FIRST CAREER AI CALL
async function sendCareer(user){

addUser(`<b>${user.name}</b><br>${user.goal}`);

addAI(`<span class="typing">ü§ñ Deep analysing your profile...</span>`);

const res=await fetch("http://localhost:5000/career",{
method:"POST",
headers:{ "Content-Type":"application/json"},
body:JSON.stringify(user)
});

const data=await res.json();

chat.lastChild.remove();

let careerHTML="";

data.careers.forEach(c=>{
careerHTML+=`
<div class="card">
<b>üéØ ${c.name}</b><br>
${c.reason}<br>
<span class="badge">${c.source}</span>
</div>`;
});

addAI(`
<h3>üöÄ Career Direction</h3>
${careerHTML}
<h3>üß≠ Roadmap</h3>
<div style="white-space:pre-line">${data.steps}</div>
`);

// ‚≠ê ACTIVATE CHAT MODE AFTER FIRST RESPONSE
chatInputBox.style.display="flex";
}

// ‚≠ê FOLLOW-UP CHAT (SKILL / CAREER QUESTIONS)
async function sendChat(){

const input=document.getElementById("chatInput");
const message=input.value.trim();

if(!message) return;

const user=JSON.parse(localStorage.getItem("userData"));

addUser(message);

input.value="";

addAI("<span class='typing'>ü§ñ Thinking...</span>");

const contextType=detectContext(message);

const res=await fetch("http://localhost:5000/chat",{
method:"POST",
headers:{ "Content-Type":"application/json"},
body:JSON.stringify({
name:user.name,
message:message,
type:contextType
})
});

const data=await res.json();

chat.lastChild.remove();

addAI(`<div style="white-space:pre-line">${data.reply}</div>`);
}

</script>

</body>
</html>
